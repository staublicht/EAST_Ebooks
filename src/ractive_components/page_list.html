<link rel='ractive' href='navbar.html?v=1' name='r-navbar'>
<link rel='ractive' href='filters.html?v=1' name='r-filters'>
<link rel='ractive' href='pagination.html?v=1' name='r-pagination'>
<link rel='ractive' href='table.html?v=1' name='r-table'>
<link rel='ractive' href='footer.html?v=1' name='r-footer'>

<r-navbar id={{menu.id}} entries={{menu.entries}} selected_index={{menu.selected_index}}>
</r-navbar>

{{#alerts}}
<r-alert type={{type}} dismissible={{dismissible}} content={{content}} />
{{/alerts}}

<r-filters
	languages={{languages}}
	categories={{categories}}
	status_tags={{status_tags}}
	selectedLang={{selectedLang}}
	selectedCat={{selectedCat}}
	selectedStatus={{selectedStatus}}
></r-filters>

<r-pagination></r-pagination>

<r-table
	status_tags={{status_tags}} columns={{table_columns}} entries={{table_entries}}
></r-table>

<r-pagination></r-pagination>

<r-footer></r-footer>


<script>
	component.exports = {
		onrender: function () {
			console.log( 'List Page loaded.');

			//select entry to edit
			this.on( 'r-table.selectEntry', function (event) {
				console.log( 'selectEntry', event );
				var loadPage = this.get('loadPage');

				if(typeof loadPage !== 'undefined'){
				    //load edit page with right book id
					loadPage( this.get('edit_page') , event.id );
				}else{
					throw new SyntaxError("loadPage is not defined!");
				}

				return false;
			});

			//TODO add observers for filters

			//function calls to request list entries from server

		},
		data: function() {
		    return {
				"selectedLang" : -1,
				"selectedCat" : -1,
				"selectedStatus" : -1,
				"table_columns" : {
					'id' : "Id",
					'author' : "Author",
					 'original_title' : "Original Title",
					 'language' : "Language",
					 'status' : "Status",
					 'release_date' : "Release Date",
					 'downloads' : "Downloads"
				},
				'table_entries' : [
					{ 'id' : 101 ,
					 'author' : 'Patrisiýa Jon',
					 'original_title' : 'Star of Light',
					 'language' : 'Turkmen',
					 'status' : 0,
					 'release_date' : '-',
					 'downloads' : '-'
					},
					{ 'id' : 102 ,
					 'author' : 'Patrisiýa Jon',
					 'original_title' : 'Star of Light',
					 'language' : 'Turkmen',
					 'status' : 2,
					 'release_date' : '-',
					 'downloads' : '-'
					},
					{ 'id' : 103 ,
					 'author' : 'Patrisiýa Jon',
					 'original_title' : 'Star of Light',
					 'language' : 'Turkmen',
					 'status' : 3,
					 'release_date' : '-',
					 'downloads' : '-'
					}

				]
			}
		}
	};
</script>
